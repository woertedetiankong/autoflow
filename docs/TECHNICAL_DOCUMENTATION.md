# AutoFlow æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [ä¸»è¦åŠŸèƒ½](#ä¸»è¦åŠŸèƒ½)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
- [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)

## ğŸš€ é¡¹ç›®æ¦‚è¿°

AutoFlow æ˜¯ä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„å¼€æºRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æ¡†æ¶ï¼Œä¸“ä¸ºæ„å»ºæ™ºèƒ½é—®ç­”ç³»ç»Ÿå’ŒçŸ¥è¯†åº“è€Œè®¾è®¡ã€‚å®ƒç»“åˆäº†å‘é‡æœç´¢å’ŒçŸ¥è¯†å›¾è°±æŠ€æœ¯ï¼Œæä¾›æ›´å‡†ç¡®ã€æ›´å…·ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„AIé—®ç­”ä½“éªŒã€‚

### æ ¸å¿ƒä»·å€¼

- **ğŸ§  æ™ºèƒ½æ£€ç´¢**ï¼šç»“åˆå‘é‡æœç´¢å’ŒçŸ¥è¯†å›¾è°±ï¼Œæä¾›æ›´ç²¾å‡†çš„ä¿¡æ¯æ£€ç´¢
- **ğŸ”— çŸ¥è¯†å…³è”**ï¼šè‡ªåŠ¨æ„å»ºå®ä½“é—´çš„å…³ç³»ç½‘ç»œï¼Œå¢å¼ºç­”æ¡ˆçš„é€»è¾‘æ€§
- **âš¡ é«˜æ€§èƒ½**ï¼šåŸºäºTiDBå‘é‡æ•°æ®åº“ï¼Œæ”¯æŒå¤§è§„æ¨¡æ•°æ®å¤„ç†
- **ğŸ›  æ˜“äºé›†æˆ**ï¼šæä¾›Python SDKå’ŒREST APIï¼Œæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼
- **ğŸŒ ä¼ä¸šçº§**ï¼šæ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ï¼Œå…·å¤‡é«˜å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§

## âœ¨ ä¸»è¦åŠŸèƒ½

### 1. çŸ¥è¯†å›¾è°±RAG
- è‡ªåŠ¨ä»æ–‡æ¡£ä¸­æå–å®ä½“å’Œå…³ç³»
- æ„å»ºçŸ¥è¯†å›¾è°±ç´¢å¼•
- åŸºäºå›¾ç»“æ„çš„æ™ºèƒ½æ£€ç´¢

### 2. å‘é‡æœç´¢
- æ”¯æŒå¤šç§åµŒå…¥æ¨¡å‹
- è¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢
- æ··åˆæ£€ç´¢ç­–ç•¥

### 3. å¯¹è¯å¼æœç´¢
- Perplexityé£æ ¼çš„å¯¹è¯ç•Œé¢
- æµå¼å“åº”
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¤šè½®å¯¹è¯

### 4. æ–‡æ¡£ç®¡ç†
- æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼ï¼ˆPDFã€Markdownã€HTMLç­‰ï¼‰
- è‡ªåŠ¨æ–‡æ¡£è§£æå’Œåˆ†å—
- æ‰¹é‡æ–‡æ¡£å¯¼å…¥

### 5. å¯åµŒå…¥ç»„ä»¶
- JavaScriptå°éƒ¨ä»¶
- ä¸€é”®é›†æˆåˆ°ç½‘ç«™
- è‡ªå®šä¹‰æ ·å¼å’Œé…ç½®

## ğŸ›  æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **æ•°æ®åº“**: [TiDB](https://www.pingcap.com/ai) - åˆ†å¸ƒå¼SQLæ•°æ®åº“ï¼Œæ”¯æŒå‘é‡æœç´¢
- **RAGæ¡†æ¶**: [LlamaIndex](https://www.llamaindex.ai/) - ä¼ä¸šçº§RAGæ¡†æ¶
- **AIç¼–ç¨‹**: [DSPy](https://github.com/stanfordnlp/dspy) - åŸºäºç¼–ç¨‹çš„AIæ¨¡å‹æ¡†æ¶
- **Webæ¡†æ¶**: FastAPI - é«˜æ€§èƒ½Python Webæ¡†æ¶
- **ä»»åŠ¡é˜Ÿåˆ—**: Celery + Redis - å¼‚æ­¥ä»»åŠ¡å¤„ç†

### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**: [Next.js](https://nextjs.org/) - Reactå…¨æ ˆæ¡†æ¶
- **æ ·å¼**: [Tailwind CSS](https://tailwindcss.com/) - å®ç”¨ä¼˜å…ˆçš„CSSæ¡†æ¶
- **ç»„ä»¶**: [shadcn/ui](https://ui.shadcn.com/) - ç°ä»£åŒ–UIç»„ä»¶åº“

### AIæ¨¡å‹æ”¯æŒ
- **LLM**: OpenAI GPTç³»åˆ—ã€Claudeã€æœ¬åœ°æ¨¡å‹ç­‰
- **åµŒå…¥æ¨¡å‹**: OpenAI Embeddingsã€æœ¬åœ°åµŒå…¥æ¨¡å‹
- **é‡æ’åº**: æ”¯æŒå¤šç§é‡æ’åºæ¨¡å‹

## ğŸ— ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```mermaid
graph TB
    subgraph "ç”¨æˆ·å±‚"
        A[Webç•Œé¢]
        B[JavaScriptå°éƒ¨ä»¶]
        C[APIå®¢æˆ·ç«¯]
    end

    subgraph "åº”ç”¨å±‚"
        D[Next.jså‰ç«¯]
        E[FastAPIåç«¯]
        F[Celeryä»»åŠ¡é˜Ÿåˆ—]
    end

    subgraph "AIæœåŠ¡å±‚"
        G[LLMæœåŠ¡]
        H[åµŒå…¥æ¨¡å‹]
        I[é‡æ’åºæ¨¡å‹]
    end

    subgraph "æ•°æ®å¤„ç†å±‚"
        J[æ–‡æ¡£è§£æå™¨]
        K[çŸ¥è¯†å›¾è°±æå–å™¨]
        L[å‘é‡ç´¢å¼•å™¨]
    end

    subgraph "å­˜å‚¨å±‚"
        M[TiDBæ•°æ®åº“]
        N[Redisç¼“å­˜]
        O[æ–‡ä»¶å­˜å‚¨]
    end

    A --> D
    B --> E
    C --> E
    D --> E
    E --> F
    E --> G
    E --> H
    E --> I
    F --> J
    F --> K
    F --> L
    J --> M
    K --> M
    L --> M
    E --> N
    F --> O
```

### æ ¸å¿ƒç»„ä»¶

#### 1. çŸ¥è¯†åº“ç®¡ç†
- **æ–‡æ¡£å­˜å‚¨**: æ”¯æŒå¤šç§æ ¼å¼çš„æ–‡æ¡£å­˜å‚¨å’Œç®¡ç†
- **åˆ†å—å¤„ç†**: æ™ºèƒ½æ–‡æ¡£åˆ†å—ï¼Œä¿æŒè¯­ä¹‰å®Œæ•´æ€§
- **ç´¢å¼•æ„å»º**: åŒæ—¶æ„å»ºå‘é‡ç´¢å¼•å’ŒçŸ¥è¯†å›¾è°±ç´¢å¼•

#### 2. æ£€ç´¢å¼•æ“
- **æ··åˆæ£€ç´¢**: ç»“åˆå‘é‡æœç´¢å’ŒçŸ¥è¯†å›¾è°±æ£€ç´¢
- **æŸ¥è¯¢ä¼˜åŒ–**: åŸºäºçŸ¥è¯†å›¾è°±ä¼˜åŒ–ç”¨æˆ·æŸ¥è¯¢
- **ç»“æœèåˆ**: æ™ºèƒ½èåˆå¤šç§æ£€ç´¢ç»“æœ

#### 3. ç”Ÿæˆå¼•æ“
- **ä¸Šä¸‹æ–‡æ„å»º**: åŸºäºæ£€ç´¢ç»“æœæ„å»ºä¸°å¯Œçš„ä¸Šä¸‹æ–‡
- **æµå¼ç”Ÿæˆ**: æ”¯æŒå®æ—¶æµå¼å“åº”
- **å¤šè½®å¯¹è¯**: ç»´æŠ¤å¯¹è¯å†å²å’Œä¸Šä¸‹æ–‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python**: 3.10+
- **Node.js**: 18+
- **æ•°æ®åº“**: TiDB æˆ– MySQL 5.7+
- **å†…å­˜**: æœ€å°‘8GB RAM
- **CPU**: 4æ ¸å¿ƒä»¥ä¸Šæ¨è

### å®‰è£…æµç¨‹å›¾

```mermaid
flowchart TD
    A[å¼€å§‹] --> B[æ£€æŸ¥ç¯å¢ƒè¦æ±‚]
    B --> C{ç¯å¢ƒæ˜¯å¦æ»¡è¶³?}
    C -->|å¦| D[å®‰è£…ä¾èµ–ç¯å¢ƒ]
    C -->|æ˜¯| E[å…‹éš†é¡¹ç›®ä»£ç ]
    D --> E
    E --> F[é…ç½®æ•°æ®åº“]
    F --> G[è®¾ç½®ç¯å¢ƒå˜é‡]
    G --> H[å¯åŠ¨æœåŠ¡]
    H --> I[éªŒè¯å®‰è£…]
    I --> J{å®‰è£…æˆåŠŸ?}
    J -->|æ˜¯| K[å®Œæˆ]
    J -->|å¦| L[æŸ¥çœ‹æ•…éšœæ’é™¤]
    L --> G
```

### 1. ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€ç®€å•çš„éƒ¨ç½²æ–¹å¼ï¼Œé€‚åˆå¿«é€Ÿä½“éªŒå’Œå¼€å‘ç¯å¢ƒã€‚

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/pingcap/autoflow.git
cd autoflow

# 2. åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶
cp .env.example .env

# 3. ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env
```

**å¿…éœ€çš„ç¯å¢ƒå˜é‡é…ç½®ï¼š**

```bash
# æ•°æ®åº“é…ç½®
TIDB_HOST=your-tidb-host
TIDB_PORT=4000
TIDB_USERNAME=your-username
TIDB_PASSWORD=your-password
TIDB_DATABASE=autoflow

# OpenAIé…ç½®
OPENAI_API_KEY=your-openai-api-key

# åº”ç”¨é…ç½®
SECRET_KEY=your-secret-key
NEXTAUTH_SECRET=your-nextauth-secret
```

```bash
# 4. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 5. éªŒè¯æœåŠ¡çŠ¶æ€
docker-compose ps
```

### 2. Python SDKå®‰è£…

å¯¹äºå¼€å‘è€…ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Python SDKï¼š

```bash
# å®‰è£…AutoFlow
pip install autoflow-ai

# æˆ–ä»æºç å®‰è£…
git clone https://github.com/pingcap/autoflow.git
cd autoflow/core
pip install -e .
```

### 3. Hello Worldç¤ºä¾‹

åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªçŸ¥è¯†åº“ï¼š

```python
import os
from autoflow import Autoflow
from autoflow.configs.db import DatabaseConfig
from autoflow.configs.main import Config
from autoflow.models.llms import LLM
from autoflow.models.embedding_models import EmbeddingModel

# åˆå§‹åŒ–AutoFlow
af = Autoflow.from_config(
    config=Config(
        db=DatabaseConfig(
            host=os.getenv("TIDB_HOST"),
            port=int(os.getenv("TIDB_PORT")),
            username=os.getenv("TIDB_USERNAME"),
            password=os.getenv("TIDB_PASSWORD"),
            database=os.getenv("TIDB_DATABASE"),
        )
    )
)

# åˆ›å»ºçŸ¥è¯†åº“
kb = af.create_knowledge_base(
    name="æˆ‘çš„ç¬¬ä¸€ä¸ªçŸ¥è¯†åº“",
    description="è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•çŸ¥è¯†åº“",
    llm=LLM("gpt-4o-mini"),
    embedding_model=EmbeddingModel("text-embedding-3-small"),
)

# æ·»åŠ æ–‡æ¡£
documents = kb.add("./my-document.pdf")
print(f"æˆåŠŸæ·»åŠ  {len(documents)} ä¸ªæ–‡æ¡£")

# æœç´¢æ–‡æ¡£
result = kb.search_documents("ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ", top_k=3)
for chunk in result.chunks:
    print(f"ç›¸å…³åº¦: {chunk.score:.3f}")
    print(f"å†…å®¹: {chunk.text[:100]}...")

# æ™ºèƒ½é—®ç­”
response = kb.ask("è¯·è§£é‡Šäººå·¥æ™ºèƒ½çš„åŸºæœ¬æ¦‚å¿µ")
print(f"å›ç­”: {response.message.content}")
```

## ğŸ§  æ ¸å¿ƒæ¦‚å¿µ

### çŸ¥è¯†åº“ (Knowledge Base)
çŸ¥è¯†åº“æ˜¯AutoFlowçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒåŒ…å«ï¼š
- **æ–‡æ¡£é›†åˆ**: åŸå§‹æ–‡æ¡£å’Œå…ƒæ•°æ®
- **å‘é‡ç´¢å¼•**: ç”¨äºè¯­ä¹‰æœç´¢çš„å‘é‡è¡¨ç¤º
- **çŸ¥è¯†å›¾è°±**: å®ä½“å’Œå…³ç³»çš„ç»“æ„åŒ–è¡¨ç¤º
- **é…ç½®ä¿¡æ¯**: æ¨¡å‹é…ç½®å’Œå¤„ç†å‚æ•°

### æ£€ç´¢æ–¹æ³• (Index Methods)
AutoFlowæ”¯æŒå¤šç§æ£€ç´¢æ–¹æ³•ï¼š
- `VECTOR_SEARCH`: åŸºäºå‘é‡çš„è¯­ä¹‰æœç´¢
- `KNOWLEDGE_GRAPH`: åŸºäºçŸ¥è¯†å›¾è°±çš„å…³ç³»æ£€ç´¢

### æ–‡æ¡£å¤„ç†æµç¨‹
1. **æ–‡æ¡£è§£æ**: æå–æ–‡æœ¬å†…å®¹å’Œç»“æ„ä¿¡æ¯
2. **æ™ºèƒ½åˆ†å—**: ä¿æŒè¯­ä¹‰å®Œæ•´æ€§çš„æ–‡æ¡£åˆ†å‰²
3. **å‘é‡åŒ–**: ç”Ÿæˆæ–‡æœ¬çš„å‘é‡è¡¨ç¤º
4. **çŸ¥è¯†æå–**: è¯†åˆ«å®ä½“å’Œå…³ç³»
5. **ç´¢å¼•æ„å»º**: å»ºç«‹æœç´¢ç´¢å¼•

## ğŸ³ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### 1. ç³»ç»Ÿè¦æ±‚
- **CPU**: 8æ ¸å¿ƒä»¥ä¸Š
- **å†…å­˜**: 16GBä»¥ä¸Š
- **å­˜å‚¨**: SSDï¼Œ100GBä»¥ä¸Š
- **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥

#### 2. æ•°æ®åº“å‡†å¤‡
æ¨èä½¿ç”¨TiDB Cloudæˆ–è‡ªå»ºTiDBé›†ç¾¤ï¼š

```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE autoflow;

-- åˆ›å»ºç”¨æˆ·ï¼ˆå¯é€‰ï¼‰
CREATE USER 'autoflow'@'%' IDENTIFIED BY 'your-password';
GRANT ALL PRIVILEGES ON autoflow.* TO 'autoflow'@'%';
FLUSH PRIVILEGES;
```

#### 3. ç¯å¢ƒé…ç½®
ç”Ÿäº§ç¯å¢ƒçš„å®Œæ•´é…ç½®ç¤ºä¾‹ï¼š

```bash
# .env ç”Ÿäº§ç¯å¢ƒé…ç½®
NODE_ENV=production

# æ•°æ®åº“é…ç½®
TIDB_HOST=your-tidb-host
TIDB_PORT=4000
TIDB_USERNAME=autoflow
TIDB_PASSWORD=your-secure-password
TIDB_DATABASE=autoflow
TIDB_SSL_ENABLED=true

# AIæ¨¡å‹é…ç½®
OPENAI_API_KEY=your-openai-api-key
OPENAI_BASE_URL=https://api.openai.com/v1

# åº”ç”¨å®‰å…¨é…ç½®
SECRET_KEY=your-very-secure-secret-key
NEXTAUTH_SECRET=your-nextauth-secret
NEXTAUTH_URL=https://your-domain.com

# Redisé…ç½®
REDIS_URL=redis://your-redis-host:6379

# æ–‡ä»¶å­˜å‚¨é…ç½®
STORAGE_TYPE=s3
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_S3_BUCKET=your-bucket-name
AWS_REGION=us-east-1

# ç›‘æ§é…ç½®
LANGFUSE_PUBLIC_KEY=your-langfuse-public-key
LANGFUSE_SECRET_KEY=your-langfuse-secret-key
LANGFUSE_HOST=https://your-langfuse-host
```
